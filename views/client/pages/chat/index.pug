extends ../../layouts/default.pug
include ./../../mixins/box-head.pug
include ./../../mixins/layout-grid.pug
include ../../mixins/notification-error.pug
include ../../mixins/notification-success.pug

block main 
    +notification-success(messages.success)
    +notification-error(messages.error)


    include ../../partials/list-btn-users.pug

    .section-product-featured.my-5
        .container.my-2
            .row 
                .col-12 
                    +box-head("Chat")


            .row 
                .col-12
                    .chat(my-id=user.id)
                        .inner-head 
                            .inner-avatar 
                                img(
                                    src=roomChat.avatar
                                    )  
                                span(class='status-light' status=user.statusOnline)
                            .inner-name 
                                span #{roomChat.title}
                                span.status-online.text-muted #{(user.statusOnline == 'online') ? 'Online' : 'Offline'}
                        
                        .inner-body 
                            each chat in chats 
                                div(class = (user.id == chat.userInfo.id ? 'inner-outgoing' : 'inner-incoming'))
                                    if (user.id != chat.userInfo.id) 
                                        .inner-avatar 
                                            img(
                                                src= chat.userInfo.avatar
                                            )  

                                    .inner-text 
                                        if (user.id != chat.userInfo.id) 
                                            small.inner-name #{chat.userInfo.fullName}
                                        if (chat.images.length > 0)
                                            .inner-image.mr-2 
                                                each image in chat.images 
                                                    div
                                                        img(src=image)
                                        if (chat.content)
                                            .inner-content #{chat.content}
                                            
                        .inner-preview
                            div(class="custom-file-container" data-upload-id="image-upload")
                        .inner-foot 
                            form(
                                action=''
                                class='inner-form'
                            )
                                label(class='btn mb-0' for='file-upload-with-preview-image-upload')
                                    i(class="fa-regular fa-image")
                                span(class='btn btn-icon')
                                    i(class="fa-regular fa-face-grin-beam")

                                input(
                                    type='text'
                                    placeholder='Aa'
                                    name='content'
                                    autocomplete='off'
                                )

                                button(class="btn btn-secondary ml-2 mr-2")
                                    i(class="fa-regular fa-paper-plane")
                                    
    div(class="tooltip" role="tooltip") 
        emoji-picker(class='light')
        
block script                     
    script(type='module' src="/js/chat.js") 